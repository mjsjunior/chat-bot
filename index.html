<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Chat</title>
	<script src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
	<script src="typed.min.js"></script>
	
	<script>
		var apiResponse = {
			msg:["Oi, eu sou a aline. ^1000 Parabéns por se preocupar em ter uma alimentação mais saudavel. ^500 Reeducação Alimentar pode parecer complexo, ^300 mas eu estou aqui para te ajudar. ^1000",
			"Antes de começarmos, qual seu nome ?",
			],
			type:"question_name"
		}

		function qualSeuNome(){
		  	nome = prompt('QUAL SEU NOME ?');
		 	var apiResponse2 = {
				msg:["OLA, "+nome+" qual sua idade ?"],
				type:"question_age"
			}
		 	executarChat(apiResponse2)
		}

		function qualSuaIdade(){
		 	idade = prompt('QUAL SUA IDADE ?');
		  	var apiResponse3 = {
				msg:["Então você tem "+idade+" anos, qual sua cidade ? "],
				type:"question_city"
			}
		   	executarChat(apiResponse3)
		}

		function qualSuaCidade(){
		 	cidade = prompt('QUAL SUA CIDADE ?');
		  	var apiResponse4 = {
				msg:["Então você mora em "+cidade+", legal!! Tchau!"],
				type:"null"
			}
		  executarChat(apiResponse4)
		}

		function executarChat(apiResponse) {
		 	var p1 = new Promise(
		    function(resolve, reject) {
		     	
		     	var printText = '';
				for(i in apiResponse.msg){
					var htmlLine = '<div><img src="http://www.casinohermes.com/wp-content/uploads/2015/11/icon-chat.png" style="width:20px;height:20px"> {{MSGTEXT}}<br /><div>';
					printText += htmlLine.replace('{{MSGTEXT}}',apiResponse.msg[i]);
				}

			 	$(function(){
			 		
			 		$("#"+apiResponse.type).typed({
			            strings: [printText],
			            typeSpeed: -80,
			            contentType:'html',
			            callback:function(){
			            	if(apiResponse.type == 'question_name'){
			            		console.log(' #Chamando nome');
		 						qualSeuNome();
		 						resolve();
			            	}
		 					if(apiResponse.type == 'question_age'){
		 						console.log(' #Chamando idade');
		 						qualSuaIdade();
		 						resolve();
		 					}
		 					if(apiResponse.type == 'question_city'){
		 						console.log(' #Chamando cidade');
		 						qualSuaCidade();
		 						resolve();
		 					}
			 			}
			        });
			    });
		    });

			p1.then()
		}

		executarChat(apiResponse)

</script>
<style>
	.typed-cursor{
		display:none;
	}
</style>
</head>
<body>
	<div id="question_name">
	</div>
	<div id="question_age">
	</div>
	<div id="question_city">
	</div>
</body>
</html>